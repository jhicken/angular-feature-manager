"use strict";angular.module("feature-manager",["ui.router"]),angular.module("feature-manager").provider("$feature",function(){var e={},t={};return{add:function(t,r){e[t]=r},updateUser:function(e){t=e},$feature:{},$get:["$state",function(r){var a=function(t,r){return e[t].test?e[t].test(r?r:void 0):void 0},i=function(t){var a,i=!1;return e[t].state?(a=e[t].state,a.indexOf("!")>-1&&(a=a.split("!")[1],i=!0),r.includes(a)?i?"hide":"show":i?"show":"hide"):void 0},n=function(r){if(e[r].rights){var a=[];for(var i in e[r].rights)t.current.permissions[e[r].rights[i]]&&a.push(t.current.permissions[e[r].rights[i]]);return d(a)}},d=function(e){return e.indexOf("DELETE")>-1?"show":e.indexOf("CREATE")>-1?"show":e.indexOf("EDIT")>-1?"show":e.indexOf("READ")>-1?"readonly":e.indexOf("NONE")>-1?"hide":"hide"},u=function(e){return e.indexOf("hide")>-1?"hide":e.indexOf("disable")>-1?"disable":e.indexOf("readonly")>-1?"readonly":"show"};return this.$feature.add=this.add,this.$feature.updateUser=this.updateUser,this.$feature.check=function(t,r){var d=[];if(!e[t])throw new Error("ERROR: Feature "+t+" has not been defined by $feature.add()");return d.push(a(t,r)),d.push(i(t)),d.push(n(t)),u(d)},this.$feature}]}}),angular.module("feature-manager").factory("toggleDisableStyles",function(){return function(e,t){var r=t.find("[ui-select2]");e?(t.addClass("disable-fields"),t.find("input","label").attr("disabled","disabled"),r.select2&&(r.attr("disabled","disabled"),r.select2("enable",!1))):(t.removeClass("disable-fields"),t.find("input","label").removeAttr("disabled"),r.select2&&r.select2("enable",!0))}}),angular.module("feature-manager").directive("featureDisableFields",function(e){return{restrict:"A",link:function(t,r,a){a.noWatch?e(!0,r):t.$watch(a.featureDisableFields,function(t){e(t,r)})}}}),angular.module("feature-manager").directive("featureName",function(e,t){return{transclude:"element",priority:1e3,terminal:!1,restrict:"A",$$tlb:!0,compile:function(r,a,i){return function(r,a,n){var d,u,s=e.check(n.featureName,r);d&&(d.remove(),d=void 0),u&&(u.$destroy(),u=void 0),"hide"!==s&&(u=r.$new(),i(r.$new(),function(e){if(d=e,"disable"!==s||e.attr("feature-disable-fields")||(e.attr("feature-disable-fields",!0),e.attr("no-watch",!0),t(!0,e)),"readonly"===s&&!e.attr("read-only-area")){e.attr("read-only-area",""),e.find("input,label").attr("disabled","disabled");var r=e.find("[ui-select2]");r.select2&&(r.attr("disabled","disabled"),r.select2("enable",!1))}a.after(e)}))}}}}),angular.module("feature-manager").directive("readOnlyArea",function(e){return{restrict:"A",link:function(t,r,a){a.noWatch?e(!0,r):t.$watch(a.featureDisableFields,function(t){e(t,r)})}}});